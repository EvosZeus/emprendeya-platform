<!-- Publicar Proyecto - Formulario Profesional y Completo -->
<div class="container ">
    <div class="page-inner">
        <div class="page-header" style="overflow: auto;">
            <span class="badge badge-success" style="float: left;">Publicar Proyecto  <font style="vertical-align: inherit;">+</font></span>
            
        </div>
        
        <div class="card shadow-sm p-4">
            <form action="#" method="POST" enctype="multipart/form-data">
                <!-- 1. Identificación Básica -->
                <h5 class="fw-bold mb-3">1. Identificación Básica</h5>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label class="form-label">Nombre del Proyecto</label>
                        <input type="text" class="form-control" name="nombre_proyecto"
                            placeholder="Nombre oficial del proyecto">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Logo del Proyecto</label>
                        <input type="file" class="form-control" name="logo" accept="image/*"
                            onchange="previewFile(this, '#logo-preview')">
                        <img id="logo-preview" src="#" alt="Logo preview" class="img-thumbnail mt-2 d-none"
                            style="max-height: 100px">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label class="form-label">Eslogan o Frase Corta</label>
                        <input type="text" class="form-control" name="eslogan">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Sector / Industria</label>
                        <select class="form-select " name="sector">
                            <option value="">Seleccione...</option>
                            <option value="Tecnología">Tecnología</option>
                            <option value="Educación">Educación</option>
                            <option value="Salud">Salud</option>
                            <option value="Agroindustria">Agroindustria</option>
                            <option value="Finanzas">Finanzas</option>
                            <option value="Medio Ambiente">Medio Ambiente</option>
                            <option value="Turismo">Turismo</option>
                            <option value="Moda">Moda</option>
                            <option value="Comercio">Comercio</option>
                            <option value="Otro">Otro</option>
                        </select>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label">País / Región</label>
                    <input type="text" class="form-control" name="region" placeholder="Ej. Colombia / Nariño">
                </div>

                <!-- Mapa de ubicación -->
                <div class="mb-3">
                    <label class="form-label">Ubicación del Proyecto</label>
                    <input type="text" class="form-control mb-2" name="ubicacion" id="ubicacion"
                        placeholder="Buscar ubicación...">
                    <div id="map" style="height: 300px; border: 1px solid #ccc;"></div>
                </div>



                <!-- 2. Resumen y Propuesta de Valor -->
                <h5 class="fw-bold mt-4 mb-3">2. Resumen y Propuesta de Valor</h5>
                <div class="mb-3">
                    <label class="form-label">Resumen Ejecutivo</label>
                    <textarea class="form-control" name="resumen" rows="3"></textarea>
                </div>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label class="form-label">Problema que Resuelve</label>
                        <textarea class="form-control" name="problema"></textarea>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Solución Ofrecida</label>
                        <textarea class="form-control" name="solucion"></textarea>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Propuesta Única de Valor</label>
                    <textarea class="form-control" name="propuesta_valor"></textarea>
                </div>

                <!-- 3. Mercado -->
                <h5 class="fw-bold mt-4 mb-3">3. Mercado</h5>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label class="form-label">Mercado Objetivo</label>
                        <textarea class="form-control" name="mercado_objetivo"></textarea>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Tamaño Estimado del Mercado</label>
                        <input type="text" class="form-control" name="tamano_mercado">
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Competencia Principal</label>
                    <textarea class="form-control" name="competencia"></textarea>
                </div>
                <div class="mb-3">
                    <label class="form-label">Ventajas Competitivas</label>
                    <textarea class="form-control" name="ventajas"></textarea>
                </div>

                <!-- 4. Modelo de Negocio -->
                <h5 class="fw-bold mt-4 mb-3">4. Modelo de Negocio</h5>
                <div class="mb-3">
                    <label class="form-label">Modelo de Ingresos</label>
                    <textarea class="form-control" name="modelo_ingresos"></textarea>
                </div>

                <!-- 5. Equipo -->
                <h5 class="fw-bold mt-4 mb-3">5. Equipo de trabajo</h5>
                <div id="fundadores-container" class="mb-3">
                    <div class="row align-items-end mb-2 fundador-item">
                        <div class="col-md-6">
                            <label class="form-label">Miembro de equipo</label>
                            <input type="text" class="form-control" name="fundadores[]" placeholder="Nombre">
                        </div>
                        <div class="col-md-5">
                            <label class="form-label">Experiencia</label>
                            <textarea class="form-control" name="experiencia_equipo[]"
                                placeholder="Experiencia relevante"></textarea>
                        </div>
                        <div class="col-md-1 text-end">
                            <button type="button" class="btn btn-danger btn-sm"
                                onclick="eliminarFundador(this)">&times;</button>
                        </div>
                    </div>
                </div>
                <button type="button" class="btn btn-outline-primary btn-sm mb-3" onclick="agregarFundador()">+ Agregar
                </button>


                <!-- 6. Finanzas -->
                <h5 class="fw-bold mt-4 mb-3">6. Finanzas e Inversión</h5>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label class="form-label">Monto de Inversión Solicitado</label>
                        <input type="number" class="form-control" name="monto_inversion">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Valoración Pre-Money (opcional)</label>
                        <input type="text" class="form-control" name="valoracion">
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Uso Detallado de los Fondos</label>
                    <textarea class="form-control" name="uso_fondos"></textarea>
                </div>
                <div class="mb-3">
                    <label class="form-label">Proyecciones Financieras (PDF)</label>
                    <input type="file" class="form-control" name="proyecciones" accept=".pdf">
                </div>

                <!-- 7. Tracción y Estado -->
                <h5 class="fw-bold mt-4 mb-3">7. Estado Actual y Tracción</h5>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label class="form-label">Etapa Actual del Proyecto</label>
                        <select class="form-select" name="etapa">
                            <option>Idea</option>
                            <option>Prototipo</option>
                            <option>MVP</option>
                            <option>Ventas Iniciales</option>
                            <option>Crecimiento</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Próximos Hitos</label>
                        <input type="text" class="form-control" name="hitos">
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Logros y Tracción</label>
                    <textarea class="form-control" name="logros"></textarea>
                </div>

                <!-- 8. Material de Apoyo -->
                <h5 class="fw-bold mt-4 mb-3">8. Material de Apoyo</h5>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label class="form-label">Pitch Deck (PDF)</label>
                        <input type="file" class="form-control" name="pitch" accept=".pdf">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Plan de Negocios (Opcional)</label>
                        <input type="file" class="form-control" name="plan_negocio" accept=".pdf,.doc,.docx">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-4">
                        <label class="form-label">Sitio Web</label>
                        <input type="url" class="form-control" name="web">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Video Pitch (opcional)</label>
                        <input type="url" class="form-control" name="video">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Demo del Producto</label>
                        <input type="url" class="form-control" name="demo">
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Imágenes relevantes</label>
                    <input type="file" class="form-control" name="imagenes[]" multiple accept="image/*"
                        onchange="previewMultiple(this, '#galeria-preview')">
                    <div id="galeria-preview" class="row mt-3 g-2"></div>
                </div>

                <!-- 9. Contacto -->
                <h5 class="fw-bold mt-4 mb-3">9. Información de Contacto</h5>
                <div class="row mb-3">
                    <div class="col-md-4">
                        <label class="form-label">Nombre Contacto</label>
                        <input type="text" class="form-control" name="contacto">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Correo Electrónico</label>
                        <input type="email" class="form-control" name="correo_contacto">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Teléfono</label>
                        <input type="tel" class="form-control" name="telefono">
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label">LinkedIn (opcional)</label>
                    <input type="url" class="form-control" name="linkedin">
                </div>

                <div class="text-end">
                    <button type="reset" class="btn btn-outline-secondary">Limpiar</button>
                    <button type="submit" class="btn btn-success">Publicar Proyecto</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- JavaScript de soporte -->
<script>
    function previewFile(input, previewId) {
        const file = input.files[0];
        const preview = document.querySelector(previewId);
        if (file) {
            const maxSize = 2 * 1024 * 1024; // 2MB
            if (file.size > maxSize) {
                alert("El archivo supera el tamaño máximo permitido de 2MB.");
                input.value = "";
                return;
            }
            const reader = new FileReader();
            reader.onload = () => {
                preview.src = reader.result;
                preview.classList.remove('d-none');
            };
            reader.readAsDataURL(file);
        }
    }

    function previewMultiple(input, containerId) {
        const container = document.querySelector(containerId);
        container.innerHTML = '';
        Array.from(input.files).forEach((file, index) => {
            if (file.size > 2 * 1024 * 1024) {
                alert(`La imagen "${file.name}" excede los 2MB y no será cargada.`);
                return;
            }
            const reader = new FileReader();
            reader.onload = () => {
                const col = document.createElement('div');
                col.className = 'col-md-3 position-relative';
                col.innerHTML = `
            <div class="border p-1 rounded position-relative">
              <img src="${reader.result}" class="img-fluid rounded" style="height: 150px; object-fit: cover; width: 100%;">
              <button type="button" class="btn btn-sm btn-danger position-absolute top-0 end-0" style="z-index: 2;" onclick="this.parentElement.parentElement.remove()">&times;</button>
            </div>
          `;
                container.appendChild(col);
            };
            reader.readAsDataURL(file);
        });
    }
</script>

<!-- Carga de mapa de Google Maps -->
<script>
    function initMap() {
        const defaultLatLng = { lat: 1.2136, lng: -77.2811 }; // Coordenadas de Pasto, Nariño
        const map = new google.maps.Map(document.getElementById("map"), {
            zoom: 12,
            center: defaultLatLng
        });

        const input = document.getElementById("ubicacion");
        const searchBox = new google.maps.places.SearchBox(input);
        map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        let marker = new google.maps.Marker({
            map,
            position: defaultLatLng,
            draggable: true
        });

        searchBox.addListener("places_changed", () => {
            const places = searchBox.getPlaces();
            if (places.length === 0) return;

            const place = places[0];
            map.setCenter(place.geometry.location);
            marker.setPosition(place.geometry.location);
        });
    }
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places&callback=initMap" async
    defer></script>

<script>
    function agregarFundador() {
        const container = document.getElementById('fundadores-container');
        const div = document.createElement('div');
        div.className = 'row align-items-end mb-2 fundador-item';
        div.innerHTML = `
            <div class="col-md-6">
              <input type="text" class="form-control" name="fundadores[]" placeholder="Nombre del fundador">
            </div>
            <div class="col-md-5">
              <textarea class="form-control" name="experiencia_equipo[]" placeholder="Experiencia relevante"></textarea>
            </div>
            <div class="col-md-1 text-end">
              <button type="button" class="btn btn-danger btn-sm" onclick="eliminarFundador(this)">&times;</button>
            </div>`;
        container.appendChild(div);
    }

    function eliminarFundador(btn) {
        btn.closest('.fundador-item').remove();
    }

    // Script para limpiar dinámicamente campos añadidos
    window.addEventListener('DOMContentLoaded', () => {
        const form = document.querySelector('form');
        form.addEventListener('reset', () => {
            // Limpiar fundadores adicionales
            const fundadores = document.querySelectorAll('.fundador-item');
            fundadores.forEach((item, index) => {
                if (index > 0) item.remove();
            });

            // Ocultar logo preview
            const logoPreview = document.getElementById('logo-preview');
            if (logoPreview) {
                logoPreview.src = "#";
                logoPreview.classList.add('d-none');
            }

            // Limpiar galería de imágenes
            const galeria = document.getElementById('galeria-preview');
            if (galeria) galeria.innerHTML = '';

            // Limpiar inputs de tipo file manualmente
            document.querySelectorAll('input[type="file"]').forEach(input => {
                input.value = "";
            });

            // Reiniciar ubicación del mapa
            if (typeof marker !== 'undefined') {
                marker.setPosition({ lat: 1.2136, lng: -77.2811 });
                map.setCenter({ lat: 1.2136, lng: -77.2811 });
            }
        });
    });
</script>